<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart City</title>
    <link href="https://fonts.googleapis.com/css?family=Montserrat" rel="stylesheet">

    <link th:href="@{/static/css/index.css}" rel="stylesheet">

</head>

<body>
<header class="header1">
    <h1 class="text1">Bine ai venit la serviciul nostru de asistență pentru parcare!</h1>
</header>
<div class="app-container">
    <div class="box">
        <div class="container1">
            <svg viewBox="0 0 960 200">
                <symbol id="s-text">
                    <text text-anchor="middle" x="50%" y="80%">Smart City</text>
                </symbol>
                <g class="g-ants">
                    <use href="#s-text" class="text-copy"></use>
                    <use href="#s-text" class="text-copy"></use>
                    <use href="#s-text" class="text-copy"></use>
                    <use href="#s-text" class="text-copy"></use>
                    <use href="#s-text" class="text-copy"></use>
                </g>
            </svg>
        </div>
        <div class="container">
            <div class="header">
                <div class="text" id="actionText">Login</div>
                <div class="underline"></div>
            </div>
            <div class="inputs" id="inputs">
            </div>
            <div class="submit-container">
                <div class="submit gray" id="signUpButton">Sign Up</div>
                <div class="submit" id="loginButton">Login</div>
            </div>
        </div>
        <div class="right-side">
            <img th:src="@{/img/image1.jpg}" alt="Img" />
        </div>
    </div>
</div>

<script th:src="@{/js/index.js}"></script>
<script th:src="@{/js/LoginSignUpReqs.js}"></script>

<footer class="footer">
    <p>&copy; 2024 SmartCity-Iași. Toate drepturile rezervate.</p>
</footer>
</body>

<script>
    window.addEventListener('beforeunload', function(event) {
        function getCookie(name) {
    const cookies = document.cookie.split(';');
    for (let i = 0; i < cookies.length; i++) {
        const cookie = cookies[i].trim();
        if (cookie.startsWith(name + '=')) {
            return cookie.substring(name.length + 1);
        }
    }
    return null;
}

const token = getCookie('token');

    fetch('/home', {
        method: 'GET',
        headers: {
            'Authorization': 'Bearer ' + token, // Include token-ul JWT în header-ul de autorizare
        }
    })
    .then(response => {
        if (response.ok) {
            // Dacă răspunsul este OK, încărcați conținutul paginii în elementul body al paginii curente
            return response.text(); // Întoarceți conținutul paginii ca text
        } else {
            // Dacă răspunsul nu este OK, aruncați o excepție
            throw new Error('Network response was not ok');
        }
    })
    .then(data => {
        // Utilizați conținutul paginii pentru a seta conținutul elementului body al paginii curente
        document.body.innerHTML = data;
        
        // Actualizați URL-ul în bara de adrese a browser-ului
        window.history.pushState({}, '', '/home');
    })
    .catch(error => {
        console.error('Error:', error);
    });
});
</script>
</html>
